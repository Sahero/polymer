<link rel="import" href="../../bower_components/polymer/polymer-element.html">

<dom-module id="mai-investigators-list-data">

    <template>
        <app-localstorage-document key="token" data="{{tokenData}}" storage="window.localStorage"></app-localstorage-document>

        <iron-ajax
                auto
                id="getInvestigatorsList"
                method="get"
                url="[[_computeURL()]]"
                headers$='{"FM-data-token": "[[tokenData.token]]"}'
                handle-as="json"
                last-response="{{investigatorsData}}"
                on-response="listLoaded"
        ></iron-ajax>
    </template>

    <script>
        (function() {
            class MaiInvestigatorsListData extends Polymer.Element {
                static get is() {
                    return 'mai-investigators-list-data';
                }

                static get properties() {
                    return {
                        investigatorsData: {
                            type: Array,
                            notify: true,
                        },
                        selectedItem: {
                            type: Object,
                            notify: true
                        }
                    }
                }

                listLoaded(data) {
                    if(data.detail.response!==null) {
                        //console.log(data.detail.response);
                        this.investigatorsData = data.detail.response;
                        this.selectedItem = this.investigatorsData[0];
                    }
                }

                _computeURL() {
                    return `https://localhost:3000/fm/getList/L131_INVESTIGATOR_List_View`;
                }

            }
            window.customElements.define(MaiInvestigatorsListData.is, MaiInvestigatorsListData);
        }());
    </script>
</dom-module>